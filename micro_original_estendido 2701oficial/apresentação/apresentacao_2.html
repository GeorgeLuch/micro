<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>Microcredenciais Paraná</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Bootswatch -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/litera/bootstrap.min.css">

  <!-- CSS próprio -->
  <link rel="stylesheet" href="../css/apresentacao.css">

  <!-- Bootstrap JS (OBRIGATÓRIO PARA MODAL) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
  
   <!-- JS global -->
  <script src="../javascript.js" defer></script>
</head>

<body>

<!-- NAV -->
<nav class="top-nav">
  <div class="nav-container" style="max-width: 1700px; width: 96%;">
    <div class="nav-logo">
      <img src="../imagem/logo_microcredenciais.png" height="80">
    </div>
  </div>
</nav>

<!-- CONTEÚDO -->
<main
  style="width: min(96vw, 1700px); margin: 32px auto 40px; padding: 24px 16px; flex: 1; box-sizing: border-box;">

  <!-- GRID PRINCIPAL -->
  <div class="row g-4 align-items-start">

    <!-- COLUNA ESQUERDA -->
    <div class="col-12 col-lg-8">

      <section class="hero-content">
        <h1 class="title">
          Apresentação - Etapa 3
          <span class="subtitle">Finalização</span>
        </h1>

        <div class="message-box">
          <p>
           Nesta última etapa, após o cursista já ter tido acesso às informações básicas, é o momento de apresentar o curso de forma mais detalhada. Comece inserindo algumas informações sobre você. Vamos lá!
           
          </p>

          <p>
           Apresente, de forma breve, a sua trajetória profissional, destacando os aspectos mais relevantes. A mensagem deve ser acolhedora, favorecendo a aproximação com os cursistas e criando um primeiro vínculo. A apresentação pode ser realizada em formato de texto ou vídeo e escrita em primeira pessoa.
          </p>

          <p>
           O texto deve ter no máximo dois parágrafos. 
          </p>
        </div>
      </section>

      <!-- TEXTO -->
      <label class="form-label fw-semibold">
        Apresentação do(a) professor(a)
      </label>

      <textarea
        id="apnprofessor"
        class="texto form-control form-control-lg mb-4"
        rows="5"
        placeholder="Escreva aqui sua apresentação">
      </textarea>

      <!-- YOUTUBE -->
      <p class="text-muted small mb-2">
  <strong>
    Observação: Para esta gravação, sugerimos um vídeo de no máximo 03 (três) minutos.
    Caso o vídeo já tenha sido gravado, basta inserir o link no campo abaixo.
  </strong>
</p>

      <label class="form-label fw-semibold" for="youtubeProfessor">
        Link do vídeo do professor
      </label>

      <input
        id="youtubeProfessor"
        type="url"
        class="form-control mb-4"
        placeholder="https://www.youtube.com/watch?v=...">
<p class="text-muted small mb-2">
  <strong>
    Currículo Lattes: Insira aqui o link do seu currículo acadêmico na Plataforma Lattes (CNPq),
    utilizado para comprovar sua formação, experiência profissional e produção acadêmica.
  </strong>
</p>
      <!-- LATTES -->
<label for="lattesUrl" class="form-label fw-semibold">
  Currículo Lattes
</label>

<input
  type="url"
  id="lattesUrl"
  class="form-control mb-4"
  placeholder="https://lattes.cnpq.br/"
>


      <!-- MENU (NÃO REMOVIDO) -->
      <div class="menu-grid">

        <a href="./apresentacao_1.html" class="menu-item blue">
          <div class="icon-container">
            <div class="icon-inner">
              <img src="../imagem/esquerda.png" style="width:50%;">
            </div>
          </div>
          <div class="label">Anterior</div>
        </a>

        <a href="../index.html" class="menu-item blue">
          <div class="icon-container">
            <div class="icon-inner">
              <img src="../imagem/home.png" style="width:50%;">
            </div>
          </div>
          <div class="label">Home</div>
        </a>

        <a href="../apresentação/apresentacao_3.html" class="menu-item blue">
          <div class="icon-container">
            <div class="icon-inner">
              <img src="../imagem/direita.png" style="width:50%;">
            </div>
          </div>
          <div class="label">Próximo</div>
        </a>

        <!--<a href="../desafio/desafio_3.html" class="menu-item blue">
          <div class="icon-container">
            <div class="icon-inner">
              <img src="../imagem/direita.png" style="width:50%;">
            </div>
          </div>
          <div class="label">Próximo</div>
        </a>-->

      </div>

    </div>

   <!-- COLUNA DIREITA – IMAGEM PERFIL -->
<div class="col-12 col-lg-4">

  <div class="card shadow-sm"
       style="
         position: fixed;
         top: 90px;
         right: 30px;
         width: 320px;
         z-index: 1050;
         margin-top: 20px;
       ">

    <div class="card-body text-center">

      <h6 class="fw-semibold mb-3">
        Clique na imagem abaixo para ver o exemplo.
      </h6>

      <img
        src="../imagem/perfil.png"
        alt="Imagem de perfil"
        class="img-fluid rounded border preview-img"
        data-bs-toggle="modal"
        data-bs-target="#modalImagemPerfil"
        style="cursor: zoom-in;"
      >

    </div>
  </div>

</div>

<!-- MODAL – IMAGEM AMPLIADA -->
<div class="modal fade" id="modalImagemPerfil" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">
          Visualização da Imagem
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Fechar">
        </button>
      </div>

      <div class="modal-body text-center">
        <img
          src="../imagem/perfil.png"
          alt="Imagem de perfil ampliada"
          class="img-fluid rounded shadow"
        >
      </div>

    </div>
  </div>
</div>

    </div>
  </div>
</div>

</main>

<!-- <Footer> -->

  <footer class="bottom-nav">
  <div class="footer-container" style="max-width: 1700px; width: 96%; margin-top: 10px;">
    <p>&copy; 2026 UVPR - Universidade Virtual do Paraná</p>
  </div>
</footer>

<!-- ======================================================
     JAVASCRIPT — AUTOSAVE + RESTORE (SEM PDF)
     Salva automaticamente todos os inputs, textareas e selects
     usando IndexedDB
====================================================== -->
<script>
/* ================= CONFIG ================= */
const DB_NAME = "microcredenciais_db";
const DB_VERSION = 1;

const STORE_META  = "meta";   // campos com id (ex: youtubeProfessor, courseName)
const STORE_TEXTS = "texts";  // campos com data-field numérico

/* ================= DB ================= */
function openDB() {
  return new Promise((resolve, reject) => {
    const req = indexedDB.open(DB_NAME, DB_VERSION);

    req.onupgradeneeded = () => {
      const db = req.result;

      if (!db.objectStoreNames.contains(STORE_META)) {
        db.createObjectStore(STORE_META, { keyPath: "key" });
      }

      if (!db.objectStoreNames.contains(STORE_TEXTS)) {
        db.createObjectStore(STORE_TEXTS, { keyPath: "field" });
      }
    };

    req.onsuccess = () => resolve(req.result);
    req.onerror = () => reject(req.error);
  });
}

/* ================= META (por ID) ================= */
async function putMeta(key, value) {
  const db = await openDB();
  const tx = db.transaction(STORE_META, "readwrite");
  tx.objectStore(STORE_META).put({
    key,
    value: value ?? ""
  });
}

async function getMeta(key) {
  const db = await openDB();
  return new Promise(resolve => {
    const req = db
      .transaction(STORE_META)
      .objectStore(STORE_META)
      .get(key);

    req.onsuccess = () => resolve(req.result?.value || "");
    req.onerror   = () => resolve("");
  });
}

/* ================= TEXTOS (por data-field) ================= */
async function putText(field, value) {
  const db = await openDB();
  const tx = db.transaction(STORE_TEXTS, "readwrite");
  tx.objectStore(STORE_TEXTS).put({
    field: Number(field),
    value: value ?? ""
  });
}

async function getAllTexts() {
  const db = await openDB();
  return new Promise(resolve => {
    const req = db
      .transaction(STORE_TEXTS)
      .objectStore(STORE_TEXTS)
      .getAll();

    req.onsuccess = () => resolve(req.result || []);
    req.onerror   = () => resolve([]);
  });
}

/* ================= AUTOSAVE + RESTORE ================= */
document.addEventListener("DOMContentLoaded", async () => {

  const fields = document.querySelectorAll(
    "input:not([type=button]):not([type=submit]), textarea, select"
  );

  /* ---------- RESTAURA ---------- */
  const texts = await getAllTexts();
  const mapTexts = {};
  texts.forEach(t => mapTexts[t.field] = t.value);

  for (const el of fields) {

    // Campos com data-field (fluxo antigo)
    if (el.dataset.field) {
      el.value = mapTexts[el.dataset.field] || "";
    }

    // Campos com id (meta)
    else if (el.id) {
      el.value = await getMeta(el.id);
    }
  }

  /* ---------- SALVA ---------- */
  fields.forEach(el => {

    const save = () => {
      if (el.dataset.field) {
        putText(el.dataset.field, el.value);
      } else if (el.id) {
        putMeta(el.id, el.value);
      }
    };

    // Digitação
    el.addEventListener("input", save);

    // Mudança de select / perda de foco
    el.addEventListener("change", save);

    // Segurança extra (blur)
    el.addEventListener("blur", save);
  });

});
</script>


</body>

</html>